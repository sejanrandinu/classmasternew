import{u as $,r as c,f as D,k as E,m as p,n as r,q as e,p as s,Q as n,x as w,F as N,S as T,a9 as u,X as z,an as d,U as m,t as b,ao as B}from"./index-BCQP80hx.js";import{Q as R}from"./QPage-DZO8eRE2.js";import{s as f}from"./supabase-3Ri18K4t.js";import{g as V}from"./index-DDlvirwQ.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"row items-center justify-between q-mb-lg"},L={class:"row q-gutter-sm"},W={class:"row q-col-gutter-md q-mb-lg"},I={class:"row items-center justify-between q-mb-sm"},K={class:"text-caption text-grey-6 text-uppercase text-weight-bold"},O={class:"bg-blue-1 q-pa-xs rounded-borders"},U={class:"text-h4 text-weight-bold text-grey-9 q-mb-xs"},X={class:"text-weight-bold"},G={class:"row q-col-gutter-md"},H={class:"col-xs-12 col-md-8"},J={class:"row items-center justify-between"},Y={class:"text-center q-py-lg text-grey-6"},Z={class:"flex flex-center bg-grey-1 rounded-borders text-grey-5",style:{height:"300px"}},ee={class:"text-center"},te={class:"col-xs-12 col-md-4"},se={class:"row q-col-gutter-sm"},oe={class:"col-6"},ae={class:"col-6"},re={class:"col-6"},le={class:"col-6"},ne={class:"text-center q-py-lg text-grey-6"},de={__name:"DashboardPage",setup(ie){const l=$(),i=c([{label:"Total Students",value:0,target:0,prefix:"",suffix:"",icon:"school",trend:0,to:"/dashboard/students"},{label:"Monthly Revenue",value:0,target:0,prefix:"LKR ",suffix:"",icon:"payments",trend:0,to:"/dashboard/fees"},{label:"Active Tutors",value:0,target:0,prefix:"",suffix:"",icon:"cast_for_education",trend:0,to:"/dashboard/tutors"},{label:"Classes Today",value:0,target:0,prefix:"",suffix:"",icon:"event_available",trend:0,to:"/dashboard/classes"}]),C=c(!0),q=c(!0),g=c("Checking..."),h=c({message:"Checking system connectivity...",color:"bg-grey-8",icon:"hourglass_empty"});D(()=>{k(),S()});const k=async()=>{if(!C.value||!q.value){h.value={message:"Configuration Config Missing! Please check .env file.",color:"bg-red-9",icon:"error"},g.value="Failed: Missing Variables";return}try{const{error:a}=await f.from("students").select("*",{count:"exact",head:!0});a?(g.value=`Failed: ${a.message} (Code: ${a.code})`,h.value={message:"Database Connection Failed",color:"bg-red-9",icon:"dns"}):(g.value="Connected Successfully - Table Found",h.value={message:"System Operational",color:"bg-green-7",icon:"check_circle"})}catch(a){g.value=`Critical Error: ${a.message}`,h.value={message:"Critical Connection Error",color:"bg-red-10",icon:"bug_report"}}},S=async()=>{try{const{count:a,error:t}=await f.from("students").select("*",{count:"exact",head:!0});t||(i.value[0].target=a||0);const{count:o,error:x}=await f.from("tutors").select("*",{count:"exact",head:!0});x||(i.value[2].target=o||0);const M=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][new Date().getDay()],{count:y}=await f.from("classes").select("*",{count:"exact",head:!0}).eq("day",M).eq("status","Active");y!==null&&(i.value[3].target=y),i.value.forEach(_=>{V.to(_,{value:_.target,duration:1.5,ease:"power2.out"})})}catch(a){console.error("Error fetching dashboard stats:",a)}},A=()=>{l.push("/dashboard/students")},Q=()=>{l.push("/dashboard/classes")},v=a=>{switch(a){case"add_student":l.push("/dashboard/students");break;case"fees":l.push("/dashboard/fees");break;case"attendance":l.push("/dashboard/attendance");break;case"message":l.push("/dashboard/messages");break}};return(a,t)=>(p(),E(R,{class:"q-pa-md"},{default:r(()=>[e("div",j,[t[4]||(t[4]=e("div",null,[e("h1",{class:"text-h4 text-weight-bold text-grey-9 q-mb-xs"},"Overview"),e("div",{class:"text-grey-6"},"Welcome back, Administrator")],-1)),e("div",L,[s(n,{unelevated:"",color:"primary",icon:"add",label:"New Admission","no-caps":"",onClick:A})])]),e("div",W,[(p(!0),w(N,null,T(i.value,(o,x)=>(p(),w("div",{class:"col-xs-12 col-sm-6 col-md-3",key:x},[s(u,{flat:"",bordered:"",class:"rounded-borders hover-card",onClick:F=>z(l).push(o.to)},{default:r(()=>[s(d,null,{default:r(()=>[e("div",I,[e("div",K,m(o.label),1),e("div",O,[s(b,{name:o.icon,color:"primary",size:"20px"},null,8,["name"])])]),e("div",U,m(o.prefix)+m(Math.round(o.value).toLocaleString())+m(o.suffix),1),e("div",{class:B(["row items-center text-caption",o.trend>0?"text-green-7":"text-red-7"])},[s(b,{name:o.trend>0?"trending_up":"trending_down",size:"16px",class:"q-mr-xs"},null,8,["name"]),e("span",X,m(Math.abs(o.trend))+"%",1),t[5]||(t[5]=e("span",{class:"text-grey-6 q-ml-xs"},"vs last month",-1))],2)]),_:2},1024)]),_:2},1032,["onClick"])]))),128))]),e("div",G,[e("div",H,[s(u,{flat:"",bordered:"",class:"rounded-borders q-mb-md hover-card"},{default:r(()=>[s(d,{class:"q-pb-none"},{default:r(()=>[e("div",J,[t[6]||(t[6]=e("div",{class:"text-h6 text-weight-bold"},"Today's Schedule",-1)),s(n,{flat:"",dense:"",color:"primary",label:"View All","no-caps":"",onClick:Q})])]),_:1}),s(d,null,{default:r(()=>[e("div",Y,[s(b,{name:"event_busy",size:"48px",color:"grey-4",class:"q-mb-sm"}),t[7]||(t[7]=e("div",null,"No classes scheduled for today",-1))])]),_:1})]),_:1}),s(u,{flat:"",bordered:"",class:"rounded-borders hover-card"},{default:r(()=>[s(d,null,{default:r(()=>[t[9]||(t[9]=e("div",{class:"text-h6 text-weight-bold q-mb-md"},"Revenue Analytics",-1)),e("div",Z,[e("div",ee,[s(b,{name:"bar_chart",size:"48px",color:"grey-4"}),t[8]||(t[8]=e("div",{class:"q-mt-sm"},"No financial data available",-1))])])]),_:1})]),_:1})]),e("div",te,[s(u,{flat:"",bordered:"",class:"rounded-borders q-mb-md bg-primary text-white"},{default:r(()=>[s(d,null,{default:r(()=>[t[10]||(t[10]=e("div",{class:"text-h6 text-weight-bold q-mb-sm"},"Quick Actions",-1)),t[11]||(t[11]=e("p",{class:"opacity-80 q-mb-lg"},"Common administrative tasks",-1)),e("div",se,[e("div",oe,[s(n,{unelevated:"",color:"white","text-color":"primary",class:"full-width text-weight-bold",label:"Add Student","no-caps":"",icon:"person_add",onClick:t[0]||(t[0]=o=>v("add_student"))})]),e("div",ae,[s(n,{outline:"",color:"white",class:"full-width",label:"Collect Fees","no-caps":"",icon:"payments",onClick:t[1]||(t[1]=o=>v("fees"))})]),e("div",re,[s(n,{outline:"",color:"white",class:"full-width",label:"Attendance","no-caps":"",icon:"qr_code_scanner",onClick:t[2]||(t[2]=o=>v("attendance"))})]),e("div",le,[s(n,{outline:"",color:"white",class:"full-width",label:"Message","no-caps":"",icon:"send",onClick:t[3]||(t[3]=o=>v("message"))})])])]),_:1})]),_:1}),s(u,{flat:"",bordered:"",class:"rounded-borders hover-card"},{default:r(()=>[s(d,null,{default:r(()=>[t[13]||(t[13]=e("div",{class:"text-h6 text-weight-bold q-mb-md"},"Recent Activity",-1)),e("div",ne,[s(b,{name:"history",size:"48px",color:"grey-4",class:"q-mb-sm"}),t[12]||(t[12]=e("div",null,"No recent activity",-1))])]),_:1})]),_:1})])])]),_:1}))}},he=P(de,[["__scopeId","data-v-d553d304"]]);export{he as default};
