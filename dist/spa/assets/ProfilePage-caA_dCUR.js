import{r as c,f as x,k as w,m as y,n as o,q as t,p as a,a9 as p,an as u,s as q,v as f,U as d,a7 as Q,W as g,t as _,Q as P}from"./index-BCQP80hx.js";import{Q as U}from"./QChip-BZCpNEhF.js";import{Q as V}from"./QForm-DzNt1E0B.js";import{Q as A}from"./QPage-DZO8eRE2.js";import{u as D}from"./use-quasar-C6NPZew5.js";import{s as i}from"./supabase-3Ri18K4t.js";const S={class:"row q-col-gutter-lg"},C={class:"col-12 col-md-4"},N={class:"text-h5 text-weight-bold text-grey-9"},k={class:"text-body1 text-weight-medium"},B={class:"col-12 col-md-8"},M={class:"row q-col-gutter-md"},z={class:"col-12 col-sm-6"},F={class:"col-12 col-sm-6"},I={class:"row justify-end q-mt-md"},H={__name:"ProfilePage",setup(W){const m=D(),n=c(!1),s=c({email:"",whatsapp_number:"",is_approved:!1,created_at:""});x(()=>{v()});const v=async()=>{const{data:{user:l}}=await i.auth.getUser();if(l){const{data:e,error:r}=await i.from("profiles").select("*").eq("id",l.id).single();!r&&e&&(s.value=e)}},b=async()=>{n.value=!0;const{data:{user:l}}=await i.auth.getUser(),{error:e}=await i.from("profiles").update({whatsapp_number:s.value.whatsapp_number,updated_at:new Date}).eq("id",l.id);n.value=!1,e?m.notify({type:"negative",message:"Update failed: "+e.message}):m.notify({type:"positive",message:"Profile updated successfully"})},h=l=>l?new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A";return(l,e)=>(y(),w(A,{class:"q-pa-lg bg-grey-1"},{default:o(()=>[t("div",S,[e[4]||(e[4]=t("div",{class:"col-12"},[t("h1",{class:"text-h4 text-weight-bold text-grey-9 q-mb-lg"},"My Profile")],-1)),t("div",C,[a(p,{flat:"",bordered:"",class:"rounded-borders bg-white"},{default:o(()=>[a(u,{class:"text-center q-pa-xl"},{default:o(()=>[a(q,{size:"120px","font-size":"52px",color:"primary","text-color":"white",class:"shadow-10 q-mb-md"},{default:o(()=>[f(d(s.value.email?s.value.email.charAt(0).toUpperCase():"U"),1)]),_:1}),t("div",N,d(s.value.email),1),a(U,{color:"green-1","text-color":"green-8",class:"q-mt-sm text-weight-bold",icon:"verified"},{default:o(()=>[f(d(s.value.is_approved?"Approved Member":"Pending Approval"),1)]),_:1})]),_:1}),a(Q),a(u,null,{default:o(()=>[e[2]||(e[2]=t("div",{class:"text-subtitle2 text-grey-6 q-mb-xs"},"Member Since",-1)),t("div",k,d(h(s.value.created_at)),1)]),_:1})]),_:1})]),t("div",B,[a(p,{flat:"",bordered:"",class:"rounded-borders bg-white"},{default:o(()=>[a(u,null,{default:o(()=>[e[3]||(e[3]=t("div",{class:"text-h6 text-weight-bold q-mb-md"},"Profile Details",-1)),a(V,{onSubmit:b,class:"q-gutter-md"},{default:o(()=>[t("div",M,[t("div",z,[a(g,{outlined:"",modelValue:s.value.email,"onUpdate:modelValue":e[0]||(e[0]=r=>s.value.email=r),label:"Email Address",readonly:"","bg-color":"grey-1"},{prepend:o(()=>[a(_,{name:"email",color:"grey-7"})]),_:1},8,["modelValue"])]),t("div",F,[a(g,{outlined:"",modelValue:s.value.whatsapp_number,"onUpdate:modelValue":e[1]||(e[1]=r=>s.value.whatsapp_number=r),label:"WhatsApp Number",mask:"###-#######",hint:"Format: 077-1234567"},{prepend:o(()=>[a(_,{name:"fa-brands fa-whatsapp",color:"green-7"})]),_:1},8,["modelValue"])])]),t("div",I,[a(P,{label:"Update Profile",type:"submit",color:"primary",unelevated:"",class:"q-px-xl",loading:n.value},null,8,["loading"])])]),_:1})]),_:1})]),_:1})])])]),_:1}))}};export{H as default};
