import{ap as ee,d as R,r as A,aq as se,f as ue,F as he,k as oe,m as Y,n as p,q as P,x as me,p as f,Q as z,t as F,a9 as K,v as q,U as k,W as H,ar as le,an as x,a5 as X,as as ge}from"./index-BCQP80hx.js";import{Q as pe}from"./QChip-BZCpNEhF.js";import{Q as we,a as J}from"./QTable-An4uF7Sr.js";import{Q as Z,a as L}from"./QItem-rw1yFefp.js";import{Q as Ce}from"./QList-CHOuisuT.js";import{Q as Ee}from"./QMenu-DrHU5L3Z.js";import{Q as ye}from"./QSpace-Bx88LnLJ.js";import{Q as ie}from"./QSelect-DCR9V7w2.js";import{Q as Me}from"./QForm-DzNt1E0B.js";import{Q as Se}from"./QPage-DZO8eRE2.js";import{C as j}from"./ClosePopup-BHdM-OXe.js";import{u as be}from"./use-quasar-C6NPZew5.js";import{s as $}from"./supabase-3Ri18K4t.js";import"./use-fullscreen-BzphbkPZ.js";import"./selection-CdExz2ft.js";import"./QItemLabel-l38w8CTe.js";import"./format-CJebrXOQ.js";var I=function(){return I=Object.assign||function(c){for(var v,d=1,h=arguments.length;d<h;d++){v=arguments[d];for(var g in v)Object.prototype.hasOwnProperty.call(v,g)&&(c[g]=v[g])}return c},I.apply(this,arguments)};var T;(function(o){var c=(function(){function a(e,t,r,n){if(this.version=e,this.errorCorrectionLevel=t,this.modules=[],this.isFunction=[],e<a.MIN_VERSION||e>a.MAX_VERSION)throw new RangeError("Version value out of range");if(n<-1||n>7)throw new RangeError("Mask value out of range");this.size=e*4+17;for(var l=[],u=0;u<this.size;u++)l.push(!1);for(var u=0;u<this.size;u++)this.modules.push(l.slice()),this.isFunction.push(l.slice());this.drawFunctionPatterns();var m=this.addEccAndInterleave(r);if(this.drawCodewords(m),n==-1)for(var C=1e9,u=0;u<8;u++){this.applyMask(u),this.drawFormatBits(u);var S=this.getPenaltyScore();S<C&&(n=u,C=S),this.applyMask(u)}h(0<=n&&n<=7),this.mask=n,this.applyMask(n),this.drawFormatBits(n),this.isFunction=[]}return a.encodeText=function(e,t){var r=o.QrSegment.makeSegments(e);return a.encodeSegments(r,t)},a.encodeBinary=function(e,t){var r=o.QrSegment.makeBytes(e);return a.encodeSegments([r],t)},a.encodeSegments=function(e,t,r,n,l,u){if(r===void 0&&(r=1),n===void 0&&(n=40),l===void 0&&(l=-1),u===void 0&&(u=!0),!(a.MIN_VERSION<=r&&r<=n&&n<=a.MAX_VERSION)||l<-1||l>7)throw new RangeError("Invalid value");var m,C;for(m=r;;m++){var S=a.getNumDataCodewords(m,t)*8,y=g.getTotalBits(e,m);if(y<=S){C=y;break}if(m>=n)throw new RangeError("Data too long")}for(var E=0,w=[a.Ecc.MEDIUM,a.Ecc.QUARTILE,a.Ecc.HIGH];E<w.length;E++){var i=w[E];u&&C<=a.getNumDataCodewords(m,i)*8&&(t=i)}for(var s=[],M=0,N=e;M<N.length;M++){var b=N[M];v(b.mode.modeBits,4,s),v(b.numChars,b.mode.numCharCountBits(m),s);for(var Q=0,_=b.getData();Q<_.length;Q++){var V=_[Q];s.push(V)}}h(s.length==C);var B=a.getNumDataCodewords(m,t)*8;h(s.length<=B),v(0,Math.min(4,B-s.length),s),v(0,(8-s.length%8)%8,s),h(s.length%8==0);for(var D=236;s.length<B;D^=253)v(D,8,s);for(var O=[];O.length*8<s.length;)O.push(0);return s.forEach(function(W,G){return O[G>>>3]|=W<<7-(G&7)}),new a(m,t,O,l)},a.prototype.getModule=function(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]},a.prototype.getModules=function(){return this.modules},a.prototype.drawFunctionPatterns=function(){for(var e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);for(var t=this.getAlignmentPatternPositions(),r=t.length,e=0;e<r;e++)for(var n=0;n<r;n++)e==0&&n==0||e==0&&n==r-1||e==r-1&&n==0||this.drawAlignmentPattern(t[e],t[n]);this.drawFormatBits(0),this.drawVersion()},a.prototype.drawFormatBits=function(e){for(var t=this.errorCorrectionLevel.formatBits<<3|e,r=t,n=0;n<10;n++)r=r<<1^(r>>>9)*1335;var l=(t<<10|r)^21522;h(l>>>15==0);for(var n=0;n<=5;n++)this.setFunctionModule(8,n,d(l,n));this.setFunctionModule(8,7,d(l,6)),this.setFunctionModule(8,8,d(l,7)),this.setFunctionModule(7,8,d(l,8));for(var n=9;n<15;n++)this.setFunctionModule(14-n,8,d(l,n));for(var n=0;n<8;n++)this.setFunctionModule(this.size-1-n,8,d(l,n));for(var n=8;n<15;n++)this.setFunctionModule(8,this.size-15+n,d(l,n));this.setFunctionModule(8,this.size-8,!0)},a.prototype.drawVersion=function(){if(!(this.version<7)){for(var e=this.version,t=0;t<12;t++)e=e<<1^(e>>>11)*7973;var r=this.version<<12|e;h(r>>>18==0);for(var t=0;t<18;t++){var n=d(r,t),l=this.size-11+t%3,u=Math.floor(t/3);this.setFunctionModule(l,u,n),this.setFunctionModule(u,l,n)}}},a.prototype.drawFinderPattern=function(e,t){for(var r=-4;r<=4;r++)for(var n=-4;n<=4;n++){var l=Math.max(Math.abs(n),Math.abs(r)),u=e+n,m=t+r;0<=u&&u<this.size&&0<=m&&m<this.size&&this.setFunctionModule(u,m,l!=2&&l!=4)}},a.prototype.drawAlignmentPattern=function(e,t){for(var r=-2;r<=2;r++)for(var n=-2;n<=2;n++)this.setFunctionModule(e+n,t+r,Math.max(Math.abs(n),Math.abs(r))!=1)},a.prototype.setFunctionModule=function(e,t,r){this.modules[t][e]=r,this.isFunction[t][e]=!0},a.prototype.addEccAndInterleave=function(e){var t=this.version,r=this.errorCorrectionLevel;if(e.length!=a.getNumDataCodewords(t,r))throw new RangeError("Invalid argument");for(var n=a.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][t],l=a.ECC_CODEWORDS_PER_BLOCK[r.ordinal][t],u=Math.floor(a.getNumRawDataModules(t)/8),m=n-u%n,C=Math.floor(u/n),S=[],y=a.reedSolomonComputeDivisor(l),E=0,w=0;E<n;E++){var i=e.slice(w,w+C-l+(E<m?0:1));w+=i.length;var s=a.reedSolomonComputeRemainder(i,y);E<m&&i.push(0),S.push(i.concat(s))}for(var M=[],N=function(b){S.forEach(function(Q,_){(b!=C-l||_>=m)&&M.push(Q[b])})},E=0;E<S[0].length;E++)N(E);return h(M.length==u),M},a.prototype.drawCodewords=function(e){if(e.length!=Math.floor(a.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");for(var t=0,r=this.size-1;r>=1;r-=2){r==6&&(r=5);for(var n=0;n<this.size;n++)for(var l=0;l<2;l++){var u=r-l,m=(r+1&2)==0,C=m?this.size-1-n:n;!this.isFunction[C][u]&&t<e.length*8&&(this.modules[C][u]=d(e[t>>>3],7-(t&7)),t++)}}h(t==e.length*8)},a.prototype.applyMask=function(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(var t=0;t<this.size;t++)for(var r=0;r<this.size;r++){var n=void 0;switch(e){case 0:n=(r+t)%2==0;break;case 1:n=t%2==0;break;case 2:n=r%3==0;break;case 3:n=(r+t)%3==0;break;case 4:n=(Math.floor(r/3)+Math.floor(t/2))%2==0;break;case 5:n=r*t%2+r*t%3==0;break;case 6:n=(r*t%2+r*t%3)%2==0;break;case 7:n=((r+t)%2+r*t%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[t][r]&&n&&(this.modules[t][r]=!this.modules[t][r])}},a.prototype.getPenaltyScore=function(){for(var e=0,t=0;t<this.size;t++){for(var r=!1,n=0,l=[0,0,0,0,0,0,0],u=0;u<this.size;u++)this.modules[t][u]==r?(n++,n==5?e+=a.PENALTY_N1:n>5&&e++):(this.finderPenaltyAddHistory(n,l),r||(e+=this.finderPenaltyCountPatterns(l)*a.PENALTY_N3),r=this.modules[t][u],n=1);e+=this.finderPenaltyTerminateAndCount(r,n,l)*a.PENALTY_N3}for(var u=0;u<this.size;u++){for(var r=!1,m=0,l=[0,0,0,0,0,0,0],t=0;t<this.size;t++)this.modules[t][u]==r?(m++,m==5?e+=a.PENALTY_N1:m>5&&e++):(this.finderPenaltyAddHistory(m,l),r||(e+=this.finderPenaltyCountPatterns(l)*a.PENALTY_N3),r=this.modules[t][u],m=1);e+=this.finderPenaltyTerminateAndCount(r,m,l)*a.PENALTY_N3}for(var t=0;t<this.size-1;t++)for(var u=0;u<this.size-1;u++){var C=this.modules[t][u];C==this.modules[t][u+1]&&C==this.modules[t+1][u]&&C==this.modules[t+1][u+1]&&(e+=a.PENALTY_N2)}for(var S=0,y=0,E=this.modules;y<E.length;y++){var w=E[y];S=w.reduce(function(M,N){return M+(N?1:0)},S)}var i=this.size*this.size,s=Math.ceil(Math.abs(S*20-i*10)/i)-1;return h(0<=s&&s<=9),e+=s*a.PENALTY_N4,h(0<=e&&e<=2568888),e},a.prototype.getAlignmentPatternPositions=function(){if(this.version==1)return[];for(var e=Math.floor(this.version/7)+2,t=Math.floor((this.version*8+e*3+5)/(e*4-4))*2,r=[6],n=this.size-7;r.length<e;n-=t)r.splice(1,0,n);return r},a.getNumRawDataModules=function(e){if(e<a.MIN_VERSION||e>a.MAX_VERSION)throw new RangeError("Version number out of range");var t=(16*e+128)*e+64;if(e>=2){var r=Math.floor(e/7)+2;t-=(25*r-10)*r-55,e>=7&&(t-=36)}return h(208<=t&&t<=29648),t},a.getNumDataCodewords=function(e,t){return Math.floor(a.getNumRawDataModules(e)/8)-a.ECC_CODEWORDS_PER_BLOCK[t.ordinal][e]*a.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][e]},a.reedSolomonComputeDivisor=function(e){if(e<1||e>255)throw new RangeError("Degree out of range");for(var t=[],r=0;r<e-1;r++)t.push(0);t.push(1);for(var n=1,r=0;r<e;r++){for(var l=0;l<t.length;l++)t[l]=a.reedSolomonMultiply(t[l],n),l+1<t.length&&(t[l]^=t[l+1]);n=a.reedSolomonMultiply(n,2)}return t},a.reedSolomonComputeRemainder=function(e,t){for(var r=t.map(function(C){return 0}),n=function(C){var S=C^r.shift();r.push(0),t.forEach(function(y,E){return r[E]^=a.reedSolomonMultiply(y,S)})},l=0,u=e;l<u.length;l++){var m=u[l];n(m)}return r},a.reedSolomonMultiply=function(e,t){if(e>>>8||t>>>8)throw new RangeError("Byte out of range");for(var r=0,n=7;n>=0;n--)r=r<<1^(r>>>7)*285,r^=(t>>>n&1)*e;return h(r>>>8==0),r},a.prototype.finderPenaltyCountPatterns=function(e){var t=e[1];h(t<=this.size*3);var r=t>0&&e[2]==t&&e[3]==t*3&&e[4]==t&&e[5]==t;return(r&&e[0]>=t*4&&e[6]>=t?1:0)+(r&&e[6]>=t*4&&e[0]>=t?1:0)},a.prototype.finderPenaltyTerminateAndCount=function(e,t,r){return e&&(this.finderPenaltyAddHistory(t,r),t=0),t+=this.size,this.finderPenaltyAddHistory(t,r),this.finderPenaltyCountPatterns(r)},a.prototype.finderPenaltyAddHistory=function(e,t){t[0]==0&&(e+=this.size),t.pop(),t.unshift(e)},a.MIN_VERSION=1,a.MAX_VERSION=40,a.PENALTY_N1=3,a.PENALTY_N2=3,a.PENALTY_N3=40,a.PENALTY_N4=10,a.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],a.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],a})();o.QrCode=c;function v(a,e,t){if(e<0||e>31||a>>>e)throw new RangeError("Value out of range");for(var r=e-1;r>=0;r--)t.push(a>>>r&1)}function d(a,e){return(a>>>e&1)!=0}function h(a){if(!a)throw new Error("Assertion error")}var g=(function(){function a(e,t,r){if(this.mode=e,this.numChars=t,this.bitData=r,t<0)throw new RangeError("Invalid argument");this.bitData=r.slice()}return a.makeBytes=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var l=n[r];v(l,8,t)}return new a(a.Mode.BYTE,e.length,t)},a.makeNumeric=function(e){if(!a.isNumeric(e))throw new RangeError("String contains non-numeric characters");for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,3);v(parseInt(e.substring(r,r+n),10),n*3+1,t),r+=n}return new a(a.Mode.NUMERIC,e.length,t)},a.makeAlphanumeric=function(e){if(!a.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");var t=[],r;for(r=0;r+2<=e.length;r+=2){var n=a.ALPHANUMERIC_CHARSET.indexOf(e.charAt(r))*45;n+=a.ALPHANUMERIC_CHARSET.indexOf(e.charAt(r+1)),v(n,11,t)}return r<e.length&&v(a.ALPHANUMERIC_CHARSET.indexOf(e.charAt(r)),6,t),new a(a.Mode.ALPHANUMERIC,e.length,t)},a.makeSegments=function(e){return e==""?[]:a.isNumeric(e)?[a.makeNumeric(e)]:a.isAlphanumeric(e)?[a.makeAlphanumeric(e)]:[a.makeBytes(a.toUtf8ByteArray(e))]},a.makeEci=function(e){var t=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)v(e,8,t);else if(e<16384)v(2,2,t),v(e,14,t);else if(e<1e6)v(6,3,t),v(e,21,t);else throw new RangeError("ECI assignment value out of range");return new a(a.Mode.ECI,0,t)},a.isNumeric=function(e){return a.NUMERIC_REGEX.test(e)},a.isAlphanumeric=function(e){return a.ALPHANUMERIC_REGEX.test(e)},a.prototype.getData=function(){return this.bitData.slice()},a.getTotalBits=function(e,t){for(var r=0,n=0,l=e;n<l.length;n++){var u=l[n],m=u.mode.numCharCountBits(t);if(u.numChars>=1<<m)return 1/0;r+=4+m+u.bitData.length}return r},a.toUtf8ByteArray=function(e){e=encodeURI(e);for(var t=[],r=0;r<e.length;r++)e.charAt(r)!="%"?t.push(e.charCodeAt(r)):(t.push(parseInt(e.substring(r+1,r+3),16)),r+=2);return t},a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",a})();o.QrSegment=g})(T||(T={}));(function(o){(function(c){var v=(function(){function d(h,g){this.ordinal=h,this.formatBits=g}return d.LOW=new d(0,1),d.MEDIUM=new d(1,0),d.QUARTILE=new d(2,3),d.HIGH=new d(3,2),d})();c.Ecc=v})(o.QrCode||(o.QrCode={}))})(T||(T={}));(function(o){(function(c){var v=(function(){function d(h,g){this.modeBits=h,this.numBitsCharCount=g}return d.prototype.numCharCountBits=function(h){return this.numBitsCharCount[Math.floor((h+7)/17)]},d.NUMERIC=new d(1,[10,12,14]),d.ALPHANUMERIC=new d(2,[9,11,13]),d.BYTE=new d(4,[8,16,16]),d.KANJI=new d(8,[8,10,12]),d.ECI=new d(7,[0,0,0]),d})();c.Mode=v})(o.QrSegment||(o.QrSegment={}))})(T||(T={}));var U=T,te="L",re={L:U.QrCode.Ecc.LOW,M:U.QrCode.Ecc.MEDIUM,Q:U.QrCode.Ecc.QUARTILE,H:U.QrCode.Ecc.HIGH},Re=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})();function ae(o){return o in re}function de(o,c){c===void 0&&(c=0);var v=[];return o.forEach(function(d,h){var g=null;d.forEach(function(a,e){if(!a&&g!==null){v.push("M".concat(g+c," ").concat(h+c,"h").concat(e-g,"v1H").concat(g+c,"z")),g=null;return}if(e===d.length-1){if(!a)return;g===null?v.push("M".concat(e+c,",").concat(h+c," h1v1H").concat(e+c,"z")):v.push("M".concat(g+c,",").concat(h+c," h").concat(e+1-g,"v1H").concat(g+c,"z"));return}a&&g===null&&(g=e)})}),v.join("")}function fe(o,c,v,d){var h=d.width,g=d.height,a=d.x,e=d.y,t=o.length+v*2,r=Math.floor(c*.1),n=t/c,l=(h||r)*n,u=(g||r)*n,m=a==null?o.length/2-l/2:a*n,C=e==null?o.length/2-u/2:e*n,S=null;if(d.excavate){var y=Math.floor(m),E=Math.floor(C),w=Math.ceil(l+m-y),i=Math.ceil(u+C-E);S={x:y,y:E,w,h:i}}return{x:m,y:C,h:u,w:l,excavation:S}}function ce(o,c){return o.slice().map(function(v,d){return d<c.y||d>=c.y+c.h?v:v.map(function(h,g){return g<c.x||g>=c.x+c.w?h:!1})})}var ne={value:{type:String,required:!0,default:""},size:{type:Number,default:100},level:{type:String,default:te,validator:function(o){return ae(o)}},background:{type:String,default:"#fff"},foreground:{type:String,default:"#000"},margin:{type:Number,required:!1,default:0},imageSettings:{type:Object,required:!1,default:function(){return{}}},gradient:{type:Boolean,required:!1,default:!1},gradientType:{type:String,required:!1,default:"linear",validator:function(o){return["linear","radial"].indexOf(o)>-1}},gradientStartColor:{type:String,required:!1,default:"#000"},gradientEndColor:{type:String,required:!1,default:"#fff"}},Ae=I(I({},ne),{renderAs:{type:String,required:!1,default:"canvas",validator:function(o){return["canvas","svg"].indexOf(o)>-1}}}),Ne=ee({name:"QRCodeSvg",props:ne,setup:function(o){var c=A(0),v=A(""),d,h=function(){var a=o.value,e=o.level,t=o.margin,r=t>>>0,n=ae(e)?e:te,l=U.QrCode.encodeText(a,re[n]).getModules();if(c.value=l.length+r*2,o.imageSettings.src){var u=fe(l,o.size,r,o.imageSettings);d={x:u.x+r,y:u.y+r,width:u.w,height:u.h},u.excavation&&(l=ce(l,u.excavation))}v.value=de(l,r)},g=function(){if(!o.gradient)return null;var a=o.gradientType==="linear"?{x1:"0%",y1:"0%",x2:"100%",y2:"100%"}:{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"};return R(o.gradientType==="linear"?"linearGradient":"radialGradient",I({id:"qr-gradient"},a),[R("stop",{offset:"0%",style:{stopColor:o.gradientStartColor}}),R("stop",{offset:"100%",style:{stopColor:o.gradientEndColor}})])};return h(),se(h),function(){return R("svg",{width:o.size,height:o.size,"shape-rendering":"crispEdges",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(c.value," ").concat(c.value)},[R("defs",{},[g()]),R("rect",{width:"100%",height:"100%",fill:o.background}),R("path",{fill:o.gradient?"url(#qr-gradient)":o.foreground,d:v.value}),o.imageSettings.src&&R("image",I({href:o.imageSettings.src},d))])}}}),_e=ee({name:"QRCodeCanvas",props:ne,setup:function(o,c){var v=A(null),d=A(null),h=function(){var a=o.value,e=o.level,t=o.size,r=o.margin,n=o.background,l=o.foreground,u=o.gradient,m=o.gradientType,C=o.gradientStartColor,S=o.gradientEndColor,y=r>>>0,E=ae(e)?e:te,w=v.value;if(w){var i=w.getContext("2d");if(i){var s=U.QrCode.encodeText(a,re[E]).getModules(),M=s.length+y*2,N=d.value,b={x:0,y:0,width:0,height:0},Q=o.imageSettings.src&&N!=null&&N.naturalWidth!==0&&N.naturalHeight!==0;if(Q){var _=fe(s,o.size,y,o.imageSettings);b={x:_.x+y,y:_.y+y,width:_.w,height:_.h},_.excavation&&(s=ce(s,_.excavation))}var V=window.devicePixelRatio||1,B=t/M*V;if(w.height=w.width=t*V,i.scale(B,B),i.fillStyle=n,i.fillRect(0,0,M,M),u){var D=void 0;m==="linear"?D=i.createLinearGradient(0,0,M,M):D=i.createRadialGradient(M/2,M/2,0,M/2,M/2,M/2),D.addColorStop(0,C),D.addColorStop(1,S),i.fillStyle=D}else i.fillStyle=l;Re?i.fill(new Path2D(de(s,y))):s.forEach(function(O,W){O.forEach(function(G,ve){G&&i.fillRect(ve+y,W+y,1,1)})}),Q&&i.drawImage(N,b.x,b.y,b.width,b.height)}}};ue(h),se(h);var g=c.attrs.style;return function(){return R(he,[R("canvas",I(I({},c.attrs),{ref:v,style:I(I({},g),{width:"".concat(o.size,"px"),height:"".concat(o.size,"px")})})),o.imageSettings.src&&R("img",{ref:d,src:o.imageSettings.src,style:{display:"none"},onLoad:h})])}}}),Pe=ee({name:"Qrcode",render:function(){var o=this.$props,c=o.renderAs,v=o.value,d=o.size,h=o.margin,g=o.level,a=o.background,e=o.foreground,t=o.imageSettings,r=o.gradient,n=o.gradientType,l=o.gradientStartColor,u=o.gradientEndColor;return R(c==="svg"?Ne:_e,{value:v,size:d,margin:h,level:g,background:a,foreground:e,imageSettings:t,gradient:r,gradientType:n,gradientStartColor:l,gradientEndColor:u})},props:Ae});const Ie={class:"row items-center justify-between q-mb-lg"},Qe={key:0,class:"flex flex-center bg-white rounded-borders q-pa-xl border-grey"},De={class:"text-center"},ze={class:"text-h6"},ke={class:"row justify-end q-mt-lg"},Te={class:"text-grey-7"},Be={class:"text-caption text-grey-6"},Oe={class:"text-caption text-grey-6"},tt={__name:"StudentsPage",setup(o){const c=be(),v=A(""),d=A(!1),h=A(!1),g=A(!1),a=A(!1),e=A(null),t=A({id:null,student_id:"",name:"",school:"",grade:"",contact:"",status:"Active"}),r=[{name:"student_id",align:"left",label:"Student ID",field:"student_id",sortable:!0},{name:"name",align:"left",label:"Name",field:"name",sortable:!0},{name:"school",align:"left",label:"School",field:"school",sortable:!0},{name:"grade",align:"left",label:"Grade",field:"grade",sortable:!0},{name:"contact",align:"left",label:"WhatsApp Number",field:"contact"},{name:"status",align:"left",label:"Status",field:"status",sortable:!0},{name:"actions",align:"right",label:"Actions",field:"actions"}],n=A([]);ue(()=>{l()});const l=async()=>{g.value=!0;const{data:w,error:i}=await $.from("students").select("*").order("created_at",{ascending:!1});i?(console.error("Error fetching students:",i),c.notify({type:"negative",message:`Failed to load students: ${i.message}`,timeout:5e3})):n.value=w,g.value=!1},u=w=>{e.value=w,a.value=!0},m=()=>{const w=document.getElementById("qr-canvas");if(!w)return;const i=document.createElement("a");i.download=`QR_${e.value.student_id}_${e.value.name}.png`,i.href=w.toDataURL(),i.click(),c.notify({type:"positive",message:"QR Code downloaded successfully",icon:"download"})},C=()=>{h.value=!1;const w="ST-2024"+Math.floor(Math.random()*1e4);t.value={id:null,student_id:w,name:"",school:"",grade:"",contact:"",status:"Active"},d.value=!0},S=w=>{h.value=!0,t.value={...w},d.value=!0},y=async()=>{g.value=!0;const w={student_id:t.value.student_id,name:t.value.name,school:t.value.school,grade:t.value.grade,contact:t.value.contact,status:t.value.status};let i=null;if(h.value&&t.value.id){const{error:s}=await $.from("students").update(w).eq("id",t.value.id);i=s}else{const{error:s}=await $.from("students").insert([w]);i=s}g.value=!1,i?(console.error("Error saving student:",i),c.notify({type:"negative",message:"Error saving student"})):(c.notify({type:"positive",message:h.value?"Student updated":"Student added"}),d.value=!1,l())},E=w=>{c.dialog({title:"Confirm",message:"Are you sure you want to delete this student?",cancel:!0,persistent:!0}).onOk(async()=>{console.log("Attempting to delete student with ID:",w),g.value=!0;const{error:i,data:s}=await $.from("students").delete().eq("id",w).select();console.log("Delete result:",{error:i,data:s}),g.value=!1,i?(console.error("Error deleting student:",i),c.notify({type:"negative",message:`Error deleting student: ${i.message}`})):(c.notify({type:"positive",message:"Student deleted successfully"}),l())})};return(w,i)=>(Y(),oe(Se,{class:"q-pa-md"},{default:p(()=>[P("div",Ie,[i[8]||(i[8]=P("h1",{class:"text-h4 text-weight-bold text-grey-9 q-mb-none"},"Students",-1)),f(z,{color:"primary",icon:"add",label:"Add Student",unelevated:"","no-caps":"",onClick:C})]),n.value.length===0?(Y(),me("div",Qe,[P("div",De,[f(F,{name:"group_off",size:"64px",color:"grey-4"}),i[9]||(i[9]=P("div",{class:"text-h6 text-grey-6 q-mt-md"},"No students found",-1)),i[10]||(i[10]=P("p",{class:"text-grey-5"},"Get started by adding a new student.",-1)),f(z,{color:"primary",label:"Add Student",unelevated:"","no-caps":"",class:"q-mt-sm",onClick:C})])])):(Y(),oe(K,{key:1,flat:"",bordered:"",class:"rounded-borders"},{default:p(()=>[f(we,{flat:"",rows:n.value,columns:r,"row-key":"id",filter:v.value},{"top-right":p(()=>[f(H,{borderless:"",dense:"",debounce:"300",modelValue:v.value,"onUpdate:modelValue":i[0]||(i[0]=s=>v.value=s),placeholder:"Search"},{append:p(()=>[f(F,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-status":p(s=>[f(J,{props:s},{default:p(()=>[f(pe,{size:"sm",color:s.row.status==="Active"?"green-1":"red-1","text-color":s.row.status==="Active"?"green-8":"red-8"},{default:p(()=>[q(k(s.row.status||"N/A"),1)]),_:2},1032,["color","text-color"])]),_:2},1032,["props"])]),"body-cell-grade":p(s=>[f(J,{props:s},{default:p(()=>[q(k(s.row.grade||"N/A"),1)]),_:2},1032,["props"])]),"body-cell-actions":p(s=>[f(J,{props:s,"auto-width":""},{default:p(()=>[f(z,{flat:"",round:"",dense:"",color:"grey-7",icon:"more_vert"},{default:p(()=>[f(Ee,{cover:"","auto-close":""},{default:p(()=>[f(Ce,null,{default:p(()=>[f(Z,{clickable:"",class:"text-primary",onClick:M=>u(s.row)},{default:p(()=>[f(L,{avatar:""},{default:p(()=>[f(F,{name:"qr_code_2"})]),_:1}),f(L,null,{default:p(()=>[...i[11]||(i[11]=[q("Generate ID Card",-1)])]),_:1})]),_:1},8,["onClick"]),f(Z,{clickable:"",onClick:M=>S(s.row)},{default:p(()=>[f(L,{avatar:""},{default:p(()=>[f(F,{name:"edit"})]),_:1}),f(L,null,{default:p(()=>[...i[12]||(i[12]=[q("Edit",-1)])]),_:1})]),_:1},8,["onClick"]),f(Z,{clickable:"",class:"text-red",onClick:M=>E(s.row.id)},{default:p(()=>[f(L,{avatar:""},{default:p(()=>[f(F,{name:"delete"})]),_:1}),f(L,null,{default:p(()=>[...i[13]||(i[13]=[q("Delete",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","filter"])]),_:1})),f(le,{modelValue:d.value,"onUpdate:modelValue":i[6]||(i[6]=s=>d.value=s)},{default:p(()=>[f(K,{style:{"min-width":"400px"}},{default:p(()=>[f(x,{class:"row items-center q-pb-none"},{default:p(()=>[P("div",ze,k(h.value?"Edit Student":"Add New Student"),1),f(ye),X(f(z,{icon:"close",flat:"",round:"",dense:""},null,512),[[j]])]),_:1}),f(x,{class:"q-pt-lg"},{default:p(()=>[f(Me,{onSubmit:y,class:"q-gutter-md"},{default:p(()=>[f(H,{outlined:"",modelValue:t.value.name,"onUpdate:modelValue":i[1]||(i[1]=s=>t.value.name=s),label:"Full Name",rules:[s=>!!s||"Name is required"]},null,8,["modelValue","rules"]),f(H,{outlined:"",modelValue:t.value.school,"onUpdate:modelValue":i[2]||(i[2]=s=>t.value.school=s),label:"School",hint:"e.g. Royal College"},null,8,["modelValue"]),f(ie,{outlined:"",modelValue:t.value.grade,"onUpdate:modelValue":i[3]||(i[3]=s=>t.value.grade=s),options:["Grade 6","Grade 7","Grade 8","Grade 9","Grade 10","Grade 11","Grade 12","Grade 13"],label:"Grade",rules:[s=>!!s||"Grade is required"]},null,8,["modelValue","rules"]),f(H,{outlined:"",modelValue:t.value.contact,"onUpdate:modelValue":i[4]||(i[4]=s=>t.value.contact=s),label:"WhatsApp Number",mask:"###-#######",hint:"Format: 077-1234567",rules:[s=>!!s||"WhatsApp number is required",s=>s.length===11||"Enter a valid number"]},null,8,["modelValue","rules"]),f(ie,{outlined:"",modelValue:t.value.status,"onUpdate:modelValue":i[5]||(i[5]=s=>t.value.status=s),options:["Active","Inactive"],label:"Status",rules:[s=>!!s||"Status is required"]},null,8,["modelValue","rules"]),P("div",ke,[X(f(z,{label:"Cancel",color:"grey-7",flat:"",class:"q-mr-sm"},null,512),[[j]]),f(z,{label:h.value?"Update":"Save",type:"submit",color:"primary",unelevated:""},null,8,["label"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),f(le,{modelValue:a.value,"onUpdate:modelValue":i[7]||(i[7]=s=>a.value=s)},{default:p(()=>[f(K,{style:{width:"350px"},class:"q-pa-md text-center"},{default:p(()=>[f(x,null,{default:p(()=>[i[14]||(i[14]=P("div",{class:"text-h6 text-weight-bold"},"Student ID Card",-1)),P("div",Te,k(e.value?.name),1)]),_:1}),f(x,{id:"qr-container",class:"flex flex-center q-py-lg bg-grey-1 rounded-borders q-mx-md"},{default:p(()=>[f(Pe,{value:e.value?.student_id,size:200,level:"H","render-as":"canvas",id:"qr-canvas"},null,8,["value"])]),_:1}),f(x,{class:"q-pt-none q-mt-md"},{default:p(()=>[P("div",Be,"ID: "+k(e.value?.student_id),1),P("div",Oe,k(e.value?.grade)+" | "+k(e.value?.school),1)]),_:1}),f(ge,{align:"center",class:"q-pb-md"},{default:p(()=>[X(f(z,{flat:"",label:"Close",color:"grey-7"},null,512),[[j]]),f(z,{color:"primary",icon:"download",label:"Download",unelevated:"",onClick:m})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{tt as default};
